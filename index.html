<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>へー！カウンター</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    text-align: center;
    padding: 50px;
    background: #f0f8ff; /* 柔らかい水色 */
  }

  h1 {
    color: #333333;
    text-shadow: 1px 1px 2px #aaaaaa;
  }

  button {
    font-size: 2rem;
    padding: 20px 50px;
    border-radius: 20px; 
    background: linear-gradient(135deg, #a0e4b0, #6ec1d6); /* 青緑系グラデ */
    border: none;
    cursor: pointer;
    box-shadow: 0 5px 12px rgba(0,0,0,0.2); 
    transition: transform 0.1s ease, box-shadow 0.1s ease;
  }

  button:active {
    transform: scale(0.95);
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  }

  #count {
    font-size: 4rem;
    margin-top: 20px;
    color: #444444;
    transition: transform 0.1s ease;
  }

  #count.animate {
    transform: scale(1.3);
  }
</style>
</head>
<body>
<h1>へー！カウンター</h1>
<button id="btn">へー！</button>
<div id="count">0</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import { getFirestore, doc, getDoc, updateDoc, onSnapshot, setDoc } 
    from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

  // Firebase 設定
  const firebaseConfig = {
    apiKey: "AIzaSyAr8etX574HAPKISDxjGNFru_WrFcNthHo",
    authDomain: "hee-counter-1.firebaseapp.com",
    projectId: "hee-counter-1",
    storageBucket: "hee-counter-1.firebasestorage.app",
    messagingSenderId: "487272221928",
    appId: "1:487272221928:web:48f40b93de7acbb8800d5d"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const btn = document.getElementById("btn");
  const countDisplay = document.getElementById("count");
  const counterRef = doc(db, "counter", "hee");

  // 「へー！」音（自分でアップした mp3 URL に置き換えてもOK）
  const sound = new Audio("https://ino-code11.github.io/hee-counter/hee.mp3");

  // 初期化
  const init = async () => {
    const snap = await getDoc(counterRef);
    if (!snap.exists()) {
      await setDoc(counterRef, { count: 0 });
    }
  };
  init();

  // ボタン押したらカウント + 音再生 + アニメーション
  btn.addEventListener("click", async () => {
    const snap = await getDoc(counterRef);
    if (snap.exists()) {
      const current = snap.data().count || 0;
      await updateDoc(counterRef, { count: current + 1 });

      sound.currentTime = 0;
      sound.play();
    }
  });

  // リアルタイムで表示更新 + アニメーション
  onSnapshot(counterRef, (docSnap) => {
    if (docSnap.exists()) {
      countDisplay.textContent = docSnap.data().count;
      countDisplay.classList.add("animate");
      setTimeout(() => countDisplay.classList.remove("animate"), 100);
    }
  });
</script>
</body>
</html>
