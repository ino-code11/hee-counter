<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>„Å∏„ÉºÔºÅ„Ç´„Ç¶„É≥„Çø„Éº</title>
<style>
  body {
    font-family: 'Comic Sans MS', sans-serif;
    text-align: center;
    padding: 50px;
    background: #fff0f5;
  }

  button {
    font-size: 2rem;
    padding: 20px 50px;
    border-radius: 30px; 
    background: linear-gradient(45deg, #ff9a9e, #fad0c4); 
    border: none;
    cursor: pointer;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
    transition: transform 0.1s ease, box-shadow 0.1s ease;
  }

  button:active {
    transform: scale(0.95);
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  }

  #count {
    font-size: 4rem;
    margin-top: 20px;
    color: #ff6f91;
    transition: transform 0.1s ease;
  }

  #count.animate {
    transform: scale(1.3);
  }

  h1 {
    color: #ff6f91;
    text-shadow: 1px 1px 3px #ffb6c1;
  }

  /* „Éè„Éº„Éà„ÉªÊòü„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
  .float {
    position: absolute;
    font-size: 1.5rem;
    user-select: none;
    pointer-events: none;
    animation: floatUp 1s ease-out forwards;
  }

  @keyframes floatUp {
    0% { opacity: 1; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(-100px) scale(1.5); }
  }
</style>
</head>
<body>
<h1>„Å∏„ÉºÔºÅ„Ç´„Ç¶„É≥„Çø„Éº</h1>
<button id="btn">„Å∏„ÉºÔºÅ</button>
<div id="count">0</div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import { getFirestore, doc, getDoc, updateDoc, onSnapshot, setDoc } 
    from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAr8etX574HAPKISDxjGNFru_WrFcNthHo",
    authDomain: "hee-counter-1.firebaseapp.com",
    projectId: "hee-counter-1",
    storageBucket: "hee-counter-1.firebasestorage.app",
    messagingSenderId: "487272221928",
    appId: "1:487272221928:web:48f40b93de7acbb8800d5d"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const btn = document.getElementById("btn");
  const countDisplay = document.getElementById("count");
  const counterRef = doc(db, "counter", "hee");

  const init = async () => {
    const snap = await getDoc(counterRef);
    if (!snap.exists()) {
      await setDoc(counterRef, { count: 0 });
    }
  };
  init();

  btn.addEventListener("click", async (e) => {
    const snap = await getDoc(counterRef);
    if (snap.exists()) {
      const current = snap.data().count || 0;
      await updateDoc(counterRef, { count: current + 1 });
    }

    // „É©„É≥„ÉÄ„É†„Åß„Éè„Éº„Éà or Êòü
    const shapes = ['‚ù§Ô∏è','‚ú®','üíñ','‚≠ê'];
    const shape = shapes[Math.floor(Math.random() * shapes.length)];

    const floatEl = document.createElement('div');
    floatEl.textContent = shape;
    floatEl.className = 'float';
    document.body.appendChild(floatEl);

    // „Éú„Çø„É≥‰ΩçÁΩÆ„Å´Âá∫Áèæ
    const rect = btn.getBoundingClientRect();
    floatEl.style.left = rect.left + rect.width/2 + 'px';
    floatEl.style.top = rect.top + 'px';

    // 1ÁßíÂæå„Å´ÂâäÈô§
    setTimeout(() => document.body.removeChild(floatEl), 1000);
  });

  onSnapshot(counterRef, (docSnap) => {
    if (docSnap.exists()) {
      countDisplay.textContent = docSnap.data().count;
      countDisplay.classList.add("animate");
      setTimeout(() => countDisplay.classList.remove("animate"), 100);
    }
  });
</script>
</body>
</html>
